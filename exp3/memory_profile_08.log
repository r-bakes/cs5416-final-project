============================================================
FAISS SEARCH SERVICE
============================================================
Node: 1
Port: 8008
============================================================
 * Serving Flask app '02_faiss_search_service'
 * Debug mode: off

[TIMING] _faiss_search_batch - START
Loading FAISS index
Filename: G:\cs5416-final-project-main\exp3\02_faiss_search_service.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     16.2 MiB     16.2 MiB           1   @profile_with_timing
    22                                         @profile
    23                                         def _faiss_search_batch(query_embeddings: np.ndarray) -> list[list[int]]:
    24                                             """Step 3: Perform FAISS ANN search for a batch of embeddings"""
    25     16.3 MiB      0.1 MiB           1       if not os.path.exists(CONFIG["faiss_index_path"]):
    26                                                 raise FileNotFoundError(
    27                                                     "FAISS index not found. Please create the index before running the pipeline."
    28                                                 )
    29                                         
    30     16.3 MiB      0.0 MiB           1       print("Loading FAISS index")
    31     16.5 MiB      0.2 MiB           1       query_embeddings = query_embeddings.astype("float32")
    32   8191.5 MiB   8175.1 MiB           1       _, indices = index.search(query_embeddings, CONFIG["retrieval_k"])
    33   8191.9 MiB      0.3 MiB           2       return [row.tolist() for row in indices]


[TIMING] _faiss_search_batch - END (took 42.28s)

[TIMING] _faiss_search_batch - START
Loading FAISS index
Filename: G:\cs5416-final-project-main\exp3\02_faiss_search_service.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     12.9 MiB     12.9 MiB           1   @profile_with_timing
    22                                         @profile
    23                                         def _faiss_search_batch(query_embeddings: np.ndarray) -> list[list[int]]:
    24                                             """Step 3: Perform FAISS ANN search for a batch of embeddings"""
    25     13.0 MiB      0.1 MiB           1       if not os.path.exists(CONFIG["faiss_index_path"]):
    26                                                 raise FileNotFoundError(
    27                                                     "FAISS index not found. Please create the index before running the pipeline."
    28                                                 )
    29                                         
    30     13.0 MiB      0.0 MiB           1       print("Loading FAISS index")
    31     13.1 MiB      0.1 MiB           1       query_embeddings = query_embeddings.astype("float32")
    32  10633.4 MiB  10620.3 MiB           1       _, indices = index.search(query_embeddings, CONFIG["retrieval_k"])
    33  10633.7 MiB      0.4 MiB           2       return [row.tolist() for row in indices]


[TIMING] _faiss_search_batch - END (took 35.26s)
